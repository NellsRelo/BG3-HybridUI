<ls:UIWidget x:Name="CharacterCreation_c"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ls="clr-namespace:ls;assembly=Code"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:noesis="clr-namespace:NoesisGUIExtensions;assembly=Noesis.GUI.Extensions"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    mc:Ignorable="d"
    d:DesignHeight="2160" d:DesignWidth="3840"
    ls:UIWidget.ContextName="CharacterCreation"
    ls:TooltipExtender.Owner="{Binding DummyCharacter}"
    d:DataContext="{d:DesignInstance {x:Type ls:DCCharacterCreation}, IsDesignTimeCreatable=True}"
    FocusDown="UIDown" FocusLeft="UILeft" FocusRight="UIRight" FocusUp="UIUp" ls:MoveFocus.FocusMovementMode="Closest" CanCacheFocusSurroundingElements="False">

    <ls:AttachedProperties.AutomationId>
        <MultiBinding StringFormat="{}CharacterCreation_c_{0}">
            <Binding Path="Layout"/>
        </MultiBinding>
    </ls:AttachedProperties.AutomationId>

    <ls:UIWidget.Resources>
        <ResourceDictionary>

            <!-- Message box to ensure user wants to activate tutorials -->
            <ls:LSMessageBoxData x:Key="MessageBoxTutorialsCheck"
                                 Text="{Binding Source='h86f06e64g4588g4798gb828gf6e0268122af', Converter={StaticResource TranslatedStringConverter}}"
                                 Title="{Binding Source='h402bb6d3gff93g4f4fga983g36460a611cab', Converter={StaticResource TranslatedStringConverter}}"
                                 UUID="UUIDTutorialsCheck" CheckBox="True" CheckBoxValue="True">
                <ls:LSMessageBoxData.Actions>
                    <ls:LSGameCommandData ActionName="{Binding Source='h31d65d36gfe5fg4f9bg9184g9f8ceee5f3ed', Converter={StaticResource TranslatedStringConverter}}"
                                          Command="{Binding DataContext.CheckShowTutorialsQuestion, RelativeSource={RelativeSource AncestorType={x:Type ls:UIWidget}}}"
                                          BoundInput="{Binding DataContext.CurrentPlayer.UIData.InputEvents, RelativeSource={RelativeSource AncestorType={x:Type ls:UIWidget}}, Converter={StaticResource FindInputEventConverter}, ConverterParameter='UIAccept'}"/>
                </ls:LSMessageBoxData.Actions>
            </ls:LSMessageBoxData>

            <ControlTemplate x:Key="originControlsTemplate">
                <ControlTemplate.Resources>
                    <BitmapImage x:Key="originFrame" UriSource="pack://application:,,,/Core;component/Assets/Shared_c/c_itemHolderAlt.png"/>
                </ControlTemplate.Resources>
                <StackPanel>
                    <ls:LSScrollViewer Style="{StaticResource gameplayPanelScrollViewerStyle}" Height="Auto" MaxHeight="640" VerticalScrollBarVisibility="Auto" Margin="0,20,0,0">
                        <ListBox x:Name="presetOrigins" ItemsPanel="{StaticResource gameplayItemsPanelTemplate}" ItemTemplate="{StaticResource OriginPortraitTemplate}" ItemsSource="{Binding SelectableOrigins}" SelectedItem="{Binding SelectedOrigin}" Style="{StaticResource gameplayIconGridStyle}">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem" BasedOn="{StaticResource CCIconTextListBoxItemStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsSelectable}" Value="False">
                                            <Setter Property="IsEnabled" Value="False"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <b:Interaction.Triggers>
                                <b:EventTrigger EventName="SelectionChanged">
                                    <b:ChangePropertyAction TargetName="customOrigins" PropertyName="SelectedItem" Value="{x:Null}" />
                                </b:EventTrigger>
                            </b:Interaction.Triggers>
                        </ListBox>
                    </ls:LSScrollViewer>
                   
                </StackPanel>
            </ControlTemplate>

            <ControlTemplate x:Key="setDaisyCamera">
                <Canvas>
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="Loaded">

                            <b:InvokeCommandAction Command="{Binding SetCameraMode}" CommandParameter="Overview"/>
                            <b:InvokeCommandAction Command="{Binding Path=SetCameraOffsets}">
                                <b:InvokeCommandAction.CommandParameter>
                                    <MultiBinding Converter="{StaticResource PassThroughConverter}">
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>-6</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>-4</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>0.5</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </b:InvokeCommandAction.CommandParameter>
                            </b:InvokeCommandAction>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </Canvas>
            </ControlTemplate>

            <ControlTemplate x:Key="setDaisyCamera_Splitscreen">
                <Canvas>
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="Loaded">

                            <b:InvokeCommandAction Command="{Binding SetCameraMode}" CommandParameter="Overview"/>
                            <b:InvokeCommandAction Command="{Binding Path=SetCameraOffsets}">
                                <b:InvokeCommandAction.CommandParameter>
                                    <MultiBinding Converter="{StaticResource PassThroughConverter}">
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>-9.9</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>-5.5</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                        <Binding>
                                            <Binding.Source>
                                                <System:Single>-4.4</System:Single>
                                            </Binding.Source>
                                        </Binding>
                                    </MultiBinding>
                                </b:InvokeCommandAction.CommandParameter>
                            </b:InvokeCommandAction>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </Canvas>
            </ControlTemplate>




        </ResourceDictionary>
    </ls:UIWidget.Resources>


    <b:Interaction.Triggers>
        <b:EventTrigger EventName="Loaded">
            <!-- Start with Tooltips enabled -->
            <b:InvokeCommandAction Command="{Binding EnableTooltipOnUIElementCommand, ElementName=CharacterCreation_c}"/>
            <b:InvokeCommandAction Command="{Binding OpenShowTutorialsQuestion}" CommandParameter="{StaticResource MessageBoxTutorialsCheck}"/>
        </b:EventTrigger>

        <b:EventTrigger EventName="GotKeyboardFocus">
            <b:InvokeCommandAction Command="{Binding ShowTooltipOnUIElementCommand, ElementName=CharacterCreation_c}" CommandParameter="{Binding Path=FocusedElement, ElementName=CharacterCreation_c}"/>
        </b:EventTrigger>
        <b:DataTrigger Binding="{Binding HasInputEnabled, ElementName=CharacterCreation_c}" Value="True">
            <b:InvokeCommandAction Command="{Binding ShowTooltipOnUIElementCommand, ElementName=CharacterCreation_c}" CommandParameter="{Binding FocusedElement, ElementName=CharacterCreation_c}"/>
        </b:DataTrigger>

        <b:EventTrigger EventName="MoveFocusUp">
            <ls:LSPlaySound Sound="UI_Shared_Hover" />
        </b:EventTrigger>

        <b:EventTrigger EventName="MoveFocusDown">
            <ls:LSPlaySound Sound="UI_Shared_Hover" />
        </b:EventTrigger>

        <b:EventTrigger EventName="MoveFocusRight">
            <ls:LSPlaySound Sound="UI_Shared_Hover" />
        </b:EventTrigger>

        <b:EventTrigger EventName="MoveFocusLeft">
            <ls:LSPlaySound Sound="UI_Shared_Hover" />
        </b:EventTrigger>
    </b:Interaction.Triggers>

    <b:Interaction.Behaviors>
        <ls:CollectionFilterBehavior x:Name="CustomOriginsCollection" ItemsSource="{Binding SelectableOrigins}" Predicate="{Binding IsCustomOriginPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="PresetOriginsCollection" ItemsSource="{Binding SelectableOrigins}" Predicate="{Binding IsNotCustomOriginPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SelectablePresetOriginsCollection" ItemsSource="{Binding SelectableOrigins}" Predicate="{Binding IsNotCustomSelectableOriginPredicate}"/>

        <ls:CollectionFilterBehavior x:Name="RaceProgressions" ItemsSource="{Binding RaceProgressionDetails.Progressions}" Predicate="{Binding IsNotSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SubRaceProgressions" ItemsSource="{Binding RaceProgressionDetails.Progressions}" Predicate="{Binding IsSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="ClassProgressions" ItemsSource="{Binding ClassProgressionDetails.Progressions}" Predicate="{Binding IsNotSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SubClassProgressions" ItemsSource="{Binding ClassProgressionDetails.Progressions}" Predicate="{Binding IsSubProgressionPredicate}"/>

        <ls:CollectionFilterBehavior x:Name="RaceSpellSelectors" ItemsSource="{Binding RaceProgressionDetails.SpellSelectors}" Predicate="{Binding IsNotSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SubRaceSpellSelectors" ItemsSource="{Binding RaceProgressionDetails.SpellSelectors}" Predicate="{Binding IsSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="ClassSpellSelectors" ItemsSource="{Binding ClassProgressionDetails.SpellSelectors}" Predicate="{Binding IsNotSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SubClassSpellSelectors" ItemsSource="{Binding ClassProgressionDetails.SpellSelectors}" Predicate="{Binding IsSubProgressionPredicate}"/>

        <ls:CollectionFilterBehavior x:Name="ClassPassiveFeatures" ItemsSource="{Binding PassiveFeatures}" Predicate="{Binding IsNotSubProgressionPredicate}"/>
        <ls:CollectionFilterBehavior x:Name="SubClassPassiveFeatures" ItemsSource="{Binding PassiveFeatures}" Predicate="{Binding IsSubProgressionPredicate}"/>

        <ls:CollectionSortBehavior x:Name="SortedRaceSkills" ItemsSource="{Binding AllSkills.RaceProficientSkills.Skills}" Comparer="{Binding SkillSortComparer}" />
        <ls:CollectionSortBehavior x:Name="SortedClassSkills" ItemsSource="{Binding AllSkills.ClassProficientSkills.Skills}" Comparer="{Binding SkillSortComparer}" />
        <ls:CollectionSortBehavior x:Name="SortedExpertiseSkills" ItemsSource="{Binding AllSkills.ExpertiseSkills.Skills}" Comparer="{Binding SkillSortComparer}" />

        <ls:CollectionSortBehavior x:Name="SortedSummarySkills" ItemsSource="{Binding ProgressionData.AllProgressions.Skills}" Comparer="{Binding SkillSortComparer}" />

        <ls:CollectionSortBehavior x:Name="SortedPreparableSpells" ItemsSource="{Binding SpellPrepare.Preparable}" Comparer="{Binding SpellByLevelSortComparer}" />
        <ls:CollectionSortBehavior x:Name="SortedPreparableSpellGroupsByLevel" ItemsSource="{Binding SpellPrepare.PreparableByLevel}" Comparer="{Binding SpellGroupByLevelSortComparer}" />
    </b:Interaction.Behaviors>

    <ls:UIWidget.ContentTemplate>
        <DataTemplate>

            <Grid x:Name="widgetBase" IsEnabled="{Binding IsLocked, Converter={StaticResource InvertBoolConverter}}">

                <b:Interaction.Triggers>
                    <b:DataTrigger Binding="{Binding CharacterCreationStep}" Value="Companion">
                        <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Collapsed" />
                        <b:ChangePropertyAction TargetName="gamePlayPage" PropertyName="Visibility" Value="Visible" />
                        <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Collapsed" />
                        <b:ChangePropertyAction TargetName="readyInfoPage" PropertyName="Visibility" Value="Collapsed" />
                    </b:DataTrigger>

                    <b:DataTrigger Binding="{Binding CharacterCreationStep}" Value="Finish">
                        <!-- Multiplayer Ready -->
                        <b:ChangePropertyAction TargetName="widgetBase" PropertyName="IsEnabled" Value="True" />
                        <b:ChangePropertyAction TargetName="gamePlayPage" PropertyName="Visibility" Value="Hidden" />
                        <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Collapsed" />
                        <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Collapsed" />
                        <b:ChangePropertyAction TargetName="readyInfoPage" PropertyName="Visibility" Value="Visible" />
                    </b:DataTrigger>
                </b:Interaction.Triggers>

                <Control x:Name="gamePlayPage" ls:MoveFocus.IsMoveFocusScope="True">

                    <Control.Template>
                        <ControlTemplate TargetType="Control">
                            <Grid>

                                <Grid>
                                    <Rectangle x:Name="bottomShading" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Height="{StaticResource bottomBackgroundHeight}" Fill="{StaticResource BottomShadingBrush}"/>
                                    <Rectangle x:Name="leftSideShading" HorizontalAlignment="Left" Width="{StaticResource leftSidePanelBackgroundWidthSplitscreen}" Fill="{StaticResource LeftSideShadingBrush}" OpacityMask="{StaticResource OpacityMaskShadingBrush}"/>

                                    <!-- FocusScope for returning from Summary -->
                                    <Grid x:Name="leftSidePanels" ls:MoveFocus.IsMoveFocusScope="True" HorizontalAlignment="Left" VerticalAlignment="Top" MinWidth="1218" Margin="0,140,0,0">
                                        
                                        <ContentControl x:Name="gameplaySubPanel" Content="{Binding .}">
                                            <b:Interaction.Triggers>
                                                <b:PropertyChangedTrigger Binding="{Binding Path=SelectedIndex, ElementName=gameplayTabs}">
                                                    <b:Interaction.Behaviors>
                                                        <b:ConditionBehavior>
                                                            <b:ConditionalExpression>
                                                                <b:ComparisonCondition LeftOperand="{Binding Path=SelectedIndex, ElementName=gameplayTabs}" Operator="NotEqual" RightOperand="-1"/>
                                                            </b:ConditionalExpression>
                                                        </b:ConditionBehavior>
                                                    </b:Interaction.Behaviors>
                                                    <!-- clear subtab panel -->
                                                    <b:ChangePropertyAction TargetName="gameplaySubPanel" PropertyName="DataContext" Value="{x:Null}"/>
                                                </b:PropertyChangedTrigger>
                                            </b:Interaction.Triggers>
                                        </ContentControl>
                                        <Control x:Name="gameplayPanel" Height="{StaticResource gameplayPanelHeightSplit}"/>
                                        <Control x:Name="appearanceContentsPanel" Height="{StaticResource gameplayPanelHeightSplit}" Width="{StaticResource gameplayPanelWidth}" HorizontalAlignment="Left" Visibility="Collapsed"/>
                                        <Control x:Name="daisyContentsPanel" Height="{StaticResource gameplayPanelHeightSplit}" Width="{StaticResource gameplayPanelWidth}" HorizontalAlignment="Right" Visibility="Collapsed"/>
                                        
                                    </Grid>

                                    <ls:LSButton x:Name="focusGameplayPanelButton" 
                                                 Visibility="Hidden" 
                                                 Tag=" "
                                                 ContentTemplate="{StaticResource ControllerButtonHint}"
                                                 Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='JumpToFromTab'}"
                                                 BoundEvent="JumpToFromTab"
                                                 HorizontalAlignment="Left"
                                                 VerticalAlignment="Top"
                                                 Margin="50,230,0,0">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click" >
                                                <b:ChangePropertyAction TargetName="leftSidePanels" PropertyName="IsEnabled" Value="True" />
                                                <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="False" />
                                                <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Visible" />
                                                <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                <b:ChangePropertyAction TargetName="bottomButtons" PropertyName="Template" Value="{StaticResource StandardBottomButtonsTemplate2}"/>
                                                <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=leftSidePanels}"/>
                                                <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource unfocusSummaryPanelStoryboard}"/>
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>


                                    <Control x:Name="appearanceBackground"/>
                                    <Control x:Name="appearancePanel" Height="{StaticResource appearancePanelHeight_SplitScreen}" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,212,50,0"/>

                                    <Grid x:Name="tabNavigation" Tag="None">
                                        <b:Interaction.Triggers>
                                            <b:DataTrigger Binding="{Binding Tag, ElementName=tabNavigation}" Value="GoBack">
                                                <b:ChangePropertyAction TargetName="tabNavigation" PropertyName="Tag" Value="None" />
                                            </b:DataTrigger>
                                        </b:Interaction.Triggers>

                                        <!-- Mode controller for appearance/gameplay mode switching -->
                                        <Grid x:Name="modeController" Tag="" Visibility="Collapsed"/>
                                        


                                        <Rectangle x:Name="tabBarBackground" Width="3000" Height="{StaticResource TabsPanelHeight}" Fill="{StaticResource NavShadingBrush}" HorizontalAlignment="Left" VerticalAlignment="Top"/>

                                        <StackPanel x:Name="tabBar" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="216,0,0,0" Width="3000" Tag="CanJumpToAppearance">

                                            <Grid x:Name="tabBarClipper" Width="3000" ClipToBounds="True" Tag="430">
                                                <!-- All the Gameplay Tabs -->
                                                <ListBox x:Name="gameplayTabs" VerticalAlignment="Center" SelectedIndex="0">
                                                    <ListBox.Template>
                                                        <ControlTemplate TargetType="ListBox">
                                                            <Grid x:Name="templateRoot">
                                                                <b:Interaction.Behaviors>
                                                                    <ls:SubListBoxBehavior x:Name="SubListBoxHelper" RootListBox="{Binding RelativeSource={RelativeSource TemplatedParent}}" DoPrevious="{Binding ElementName=prevTabButton, Path=IsPressed}" DoNext="{Binding ElementName=nextTabButton, Path=IsPressed}"/>
                                                                </b:Interaction.Behaviors>

                                                                <!-- No ScrollViewer -->
                                                                <Grid x:Name="backplate" Width="{Binding ElementName=SubListBoxHelper, Path=BackplateWidth}" MinWidth="{Binding ElementName=SubListBoxHelper, Path=RootListBox.SelectedItem.ActualWidth}"
                                                                      Height="{StaticResource TabsPanelHeight}" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Hidden">
                                                                    <Grid.Tag>
                                                                        <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                            <!-- Tab Offset -->
                                                                            <Binding ElementName="SubListBoxHelper" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                            <Binding ElementName="tabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>
                                                                            <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                            <!-- Add backplate offset -->
                                                                            <Binding ElementName="SubListBoxHelper" Path="BackplateOffset"/>
                                                                        </MultiBinding>
                                                                    </Grid.Tag>

                                                                    <Grid.Background>
                                                                        <LinearGradientBrush Opacity="1.0" StartPoint="0,0" EndPoint="0,1">
                                                                            <GradientStop Offset="0" Color="{StaticResource transparentBlack}"/>
                                                                            <GradientStop Offset="0.5" Color="#70af8768"/>
                                                                            <GradientStop Offset="1.0" Color="#b0af8768" />
                                                                        </LinearGradientBrush>
                                                                    </Grid.Background>

                                                                    <!-- Set Backplate position - todo improve animation -->
                                                                    <Grid.RenderTransform>
                                                                        <TranslateTransform X="{Binding ElementName=backplate,Path=Tag}" Y="0"/>
                                                                    </Grid.RenderTransform>

                                                                    <Grid.Resources>
                                                                        <Storyboard x:Key="SlideBackplateAnimation">
                                                                            <!-- FillBehavior cannot be set to Stop as that will cause some animation issues (see GUSX-14736 for more details) -->
                                                                            <DoubleAnimation Storyboard.TargetName="backplate" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource BackplateSlideAnimationDuration}"
                                                                                AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=backplate,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                        </Storyboard>
                                                                    </Grid.Resources>

                                                                    <b:Interaction.Triggers>

                                                                        <!-- Animated SelectedOffset -->
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=SubListBoxHelper}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource SlideBackplateAnimation}"/>

                                                                            <!-- Ensure offset calculated after startup animations have completed -->
                                                                            <ls:LSControlStoryboard ControlStoryboardOption="Play" >
                                                                                <ls:LSControlStoryboard.Storyboard>
                                                                                    <Storyboard x:Name="initialBackplateWidthSetting" Duration="0:0:0.4">
                                                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="backplate">
                                                                                            <DiscreteObjectKeyFrame KeyTime="0:0:0.4" Value="{x:Static Visibility.Visible}"/>
                                                                                        </ObjectAnimationUsingKeyFrames>
                                                                                    </Storyboard>
                                                                                </ls:LSControlStoryboard.Storyboard>
                                                                            </ls:LSControlStoryboard>
                                                                        </b:PropertyChangedTrigger>

                                                                        <!-- When the storyboard is triggered, the Tag value bound to the To property keeps changing during the animation, so it could be that the animation ends and, then, 
                                                                        the Tag value changes again, resulting on a wrong end position, so we need to check if the final position is the proper one and, otherwise, retrigger the animation -->
                                                                        <b:StoryboardCompletedTrigger Storyboard="{StaticResource SlideBackplateAnimation}">
                                                                            <b:Interaction.Behaviors>
                                                                                <b:ConditionBehavior>
                                                                                    <b:ConditionalExpression>
                                                                                        <b:ComparisonCondition LeftOperand="{Binding ElementName=backplate, Path=(UIElement.RenderTransform).(TranslateTransform.X)}" Operator="NotEqual" RightOperand="{Binding ElementName=backplate, Path=Tag}"/>
                                                                                    </b:ConditionalExpression>
                                                                                </b:ConditionBehavior>
                                                                            </b:Interaction.Behaviors>
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource SlideBackplateAnimation}"/>
                                                                        </b:StoryboardCompletedTrigger>

                                                                        <!-- For when Splitscreen changes -->
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=Tag, ElementName=tabBarClipper}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play">
                                                                                <b:ControlStoryboardAction.Storyboard>
                                                                                    <Storyboard x:Name="slideBackplateSplitscreen">
                                                                                        <DoubleAnimation Storyboard.TargetName="backplate" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource BackplateSlideAnimationDuration}"
                                                                                                         AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=backplate,Path=Tag}" FillBehavior="Stop"/>
                                                                                    </Storyboard>
                                                                                </b:ControlStoryboardAction.Storyboard>
                                                                            </b:ControlStoryboardAction>
                                                                        </b:PropertyChangedTrigger>
                                                                        <b:TimerTrigger EventName="Loaded" SourceName="tabBarButtons" MillisecondsPerTick="280" TotalTicks="1">

                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play">
                                                                                <b:ControlStoryboardAction.Storyboard>
                                                                                    <Storyboard >
                                                                                        <DoubleAnimation Storyboard.TargetName="backplate" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="0:0:0.02" From="300"
                                                                                                         To="{Binding ElementName=backplate,Path=Tag}" FillBehavior="Stop"/>
                                                                                    </Storyboard>
                                                                                </b:ControlStoryboardAction.Storyboard>
                                                                            </b:ControlStoryboardAction>
                                                                        </b:TimerTrigger>

                                                                    </b:Interaction.Triggers>
                                                                </Grid>

                                                                <Grid x:Name="itemsPanel">
                                                                    <Grid.Tag>
                                                                        <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                            <Binding ElementName="SubListBoxHelper" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                            <Binding ElementName="tabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>

                                                                            <!-- Added to center tab over related gameplay panel -->
                                                                            <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                        </MultiBinding>
                                                                    </Grid.Tag>

                                                                    <Grid.RenderTransform>
                                                                        <TranslateTransform X="{Binding ElementName=itemsPanel,Path=Tag}" Y="0"/>
                                                                    </Grid.RenderTransform>

                                                                    <Grid.Resources>
                                                                        <Storyboard x:Key="ScrollTabsAnimation">
                                                                            <!-- FillBehavior cannot be set to Stop as that will cause some animation issues (see GUSX-14736 for more details) -->
                                                                            <DoubleAnimation Storyboard.TargetName="itemsPanel" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource TabsSlideAnimationDuration}"
                                                                                AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=itemsPanel,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                        </Storyboard>
                                                                    </Grid.Resources>

                                                                    <b:Interaction.Triggers>
                                                                        <!-- Animated SelectedOffset -->
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=SubListBoxHelper}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource ScrollTabsAnimation}"/>
                                                                        </b:PropertyChangedTrigger>

                                                                        <!-- When the storyboard is triggered, the Tag value bound to the To property keeps changing during the animation, so it could be that the animation ends and, then, 
                                                                        the Tag value changes again, resulting on a wrong end position, so we need to check if the final position is the proper one and, otherwise, retrigger the animation -->
                                                                        <b:StoryboardCompletedTrigger Storyboard="{StaticResource ScrollTabsAnimation}">
                                                                            <b:Interaction.Behaviors>
                                                                                <b:ConditionBehavior>
                                                                                    <b:ConditionalExpression>
                                                                                        <b:ComparisonCondition LeftOperand="{Binding ElementName=itemsPanel, Path=(UIElement.RenderTransform).(TranslateTransform.X)}" Operator="NotEqual" RightOperand="{Binding ElementName=itemsPanel, Path=Tag}"/>
                                                                                    </b:ConditionalExpression>
                                                                                </b:ConditionBehavior>
                                                                            </b:Interaction.Behaviors>
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource ScrollTabsAnimation}"/>
                                                                        </b:StoryboardCompletedTrigger>

                                                                        <!-- For when Splitscreen changes -->
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=Tag, ElementName=tabBarClipper}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play">
                                                                                <b:ControlStoryboardAction.Storyboard>
                                                                                    <Storyboard x:Name="scrollTabsSplitscreen">
                                                                                        <DoubleAnimation Storyboard.TargetName="itemsPanel" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource TabsSlideAnimationDuration}"
                                                                                                         AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=itemsPanel,Path=Tag}" FillBehavior="Stop"/>
                                                                                    </Storyboard>
                                                                                </b:ControlStoryboardAction.Storyboard>
                                                                            </b:ControlStoryboardAction>
                                                                        </b:PropertyChangedTrigger>
                                                                        <b:TimerTrigger EventName="Loaded" SourceName="tabBarButtons" MillisecondsPerTick="280" TotalTicks="1">

                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play">
                                                                                <b:ControlStoryboardAction.Storyboard>
                                                                                    <Storyboard >
                                                                                        <DoubleAnimation Storyboard.TargetName="itemsPanel" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="0:0:0.02" From="300"
                                                                                                         To="{Binding ElementName=itemsPanel,Path=Tag}" FillBehavior="Stop"/>
                                                                                    </Storyboard>

                                                                                </b:ControlStoryboardAction.Storyboard>
                                                                            </b:ControlStoryboardAction>
                                                                        </b:TimerTrigger>

                                                                    </b:Interaction.Triggers>
                                                                    <ItemsPresenter/>

                                                                </Grid>

                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <!-- Animated Tabs Backplate Width matching -->
                                                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="race">
                                                                    <Setter TargetName="backplate" Property="Width">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                                <Binding Path="ActualWidth" ElementName="raceTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="subRaceTab"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="subrace">
                                                                    <Setter TargetName="backplate" Property="Width">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                                <Binding Path="ActualWidth" ElementName="raceTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="subRaceTab"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="class">
                                                                    <Setter TargetName="backplate" Property="Width">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                                <Binding Path="ActualWidth" ElementName="classTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="subClassTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="deityTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="spellPrepTab"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="subclass">
                                                                    <Setter TargetName="backplate" Property="Width">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                                <Binding Path="ActualWidth" ElementName="classTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="subClassTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="deityTab"/>
                                                                                <Binding Path="ActualWidth" ElementName="spellPrepTab"/>
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </ListBox.Template>
                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <StackPanel IsItemsHost="True" Orientation="Horizontal"/>
                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>

                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="Template" Value="{StaticResource gameplayTabTemplate2}"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>

                                                    <b:Interaction.Triggers>
                                                        <!-- Only set if not in a subtab -->
                                                        <b:EventTrigger EventName="SelectionChanged">
                                                            <b:Interaction.Behaviors>
                                                                <b:ConditionBehavior>
                                                                    <b:ConditionalExpression>
                                                                        <b:ComparisonCondition LeftOperand="{Binding ElementName=gameplayTabs, Path=SelectedIndex}" Operator="NotEqual" RightOperand="-1"/>
                                                                    </b:ConditionalExpression>
                                                                </b:ConditionBehavior>
                                                            </b:Interaction.Behaviors>
                                                            <b:ChangePropertyAction TargetName="gameplayTabs" PropertyName="Tag" Value="{Binding SelectedIndex, ElementName=gameplayTabs}" />
                                                        </b:EventTrigger>

                                                    </b:Interaction.Triggers>

                                                    <ListBoxItem x:Name="originTab" Tag="origin" />

                                                    <ListBoxItem x:Name="raceTab" Tag="race"/>
                                                    <ListBoxItem x:Name="subRaceTab" Tag="subrace" IsEnabled="{Binding SelectableSubRaces.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>

                                                    <ListBoxItem x:Name="classTab" Tag="class"/>
                                                    <ListBoxItem x:Name="subClassTab" Tag="subclass" IsEnabled="{Binding SelectableSubClasses.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>
                                                    <ListBoxItem x:Name="deityTab" Tag="deity" IsEnabled="{Binding SelectableDeities.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>
                                                    <ListBoxItem x:Name="spellPrepTab" Tag="spellprep" IsEnabled="{Binding SpellPrepare.Preparable.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>

                                                    <ListBoxItem x:Name="backgroundTab" Tag="background"/>
                                                    <ListBoxItem x:Name="featTab" Tag="feats" IsEnabled="{Binding SelectableFeats.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>
                                                    <ListBoxItem x:Name="featDetailsTab" Tag="featdetails" Visibility="{Binding SelectedFeatDetails.HasFeat, Converter={StaticResource BoolToVisibleConverter}}"/>

                                                    <ListBoxItem x:Name="abilityTab" Tag="ability"/>
                                                    <ListBoxItem x:Name="raceSkillsTab" Tag="raceskills" IsEnabled="{Binding AllSkills.RaceProficientSkills.MaxSelectedSkillCount, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>
                                                    <ListBoxItem x:Name="skillsTab" Tag="skills" IsEnabled="{Binding AllSkills.ClassProficientSkills.MaxSelectedSkillCount, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>
                                                    <ListBoxItem x:Name="expertiseTab" Tag="expertise" IsEnabled="{Binding AllSkills.ExpertiseSkills.MaxSelectedSkillCount, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}"/>

                                                </ListBox>

                                                <!-- New Appearance Tabs System -->
                                                <ListBox x:Name="appearanceTabs" VerticalAlignment="Center" SelectedIndex="0" Visibility="Collapsed" Height="{Binding ElementName=gameplayTabs, Path=ActualHeight}" Width="{Binding ElementName=gameplayTabs, Path=ActualWidth}">
                                                    <ListBox.Template>
                                                        <ControlTemplate TargetType="ListBox">
                                                            <Grid x:Name="templateRoot">
                                                                <b:Interaction.Behaviors>
                                                                    <ls:SubListBoxBehavior x:Name="AppearanceTabNavigator" RootListBox="{Binding RelativeSource={RelativeSource TemplatedParent}}" DoPrevious="{Binding ElementName=prevTabButton, Path=IsPressed}" DoNext="{Binding ElementName=nextTabButton, Path=IsPressed}"/>
                                                                </b:Interaction.Behaviors>

                                                                <!-- Appearance backplate -->
                                                                <Grid x:Name="appearanceBackplate" Width="{Binding ElementName=AppearanceTabNavigator, Path=BackplateWidth}" MinWidth="{Binding ElementName=AppearanceTabNavigator, Path=RootListBox.SelectedItem.ActualWidth}"
                                                                      Height="{StaticResource TabsPanelHeight}" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible">
                                                                    <Grid.Tag>
                                                                        <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                            <Binding ElementName="AppearanceTabNavigator" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                            <Binding ElementName="appearanceTabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>
                                                                            <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                            <Binding ElementName="AppearanceTabNavigator" Path="BackplateOffset"/>
                                                                        </MultiBinding>
                                                                    </Grid.Tag>

                                                                    <Grid.Background>
                                                                        <LinearGradientBrush Opacity="1.0" StartPoint="0,0" EndPoint="0,1">
                                                                            <GradientStop Offset="0" Color="{StaticResource transparentBlack}"/>
                                                                            <GradientStop Offset="0.5" Color="#70af8768"/>
                                                                            <GradientStop Offset="1.0" Color="#b0af8768" />
                                                                        </LinearGradientBrush>
                                                                    </Grid.Background>

                                                                    <Grid.RenderTransform>
                                                                        <TranslateTransform X="{Binding ElementName=appearanceBackplate,Path=Tag}" Y="0"/>
                                                                    </Grid.RenderTransform>

                                                                    <Grid.Resources>
                                                                        <Storyboard x:Key="SlideAppearanceBackplateAnimation">
                                                                            <DoubleAnimation Storyboard.TargetName="appearanceBackplate" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource BackplateSlideAnimationDuration}"
                                                                                AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=appearanceBackplate,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                        </Storyboard>
                                                                    </Grid.Resources>

                                                                    <b:Interaction.Triggers>
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=AppearanceTabNavigator}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource SlideAppearanceBackplateAnimation}"/>
                                                                            <ls:LSControlStoryboard ControlStoryboardOption="Play" >
                                                                                <ls:LSControlStoryboard.Storyboard>
                                                                                    <Storyboard x:Name="initialAppearanceBackplateWidthSetting" Duration="0:0:0.1">
                                                                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="appearanceBackplate">
                                                                                            <DiscreteObjectKeyFrame KeyTime="0:0:0.1" Value="{x:Static Visibility.Visible}"/>
                                                                                        </ObjectAnimationUsingKeyFrames>
                                                                                    </Storyboard>
                                                                                </ls:LSControlStoryboard.Storyboard>
                                                                            </ls:LSControlStoryboard>
                                                                        </b:PropertyChangedTrigger>
                                                                    </b:Interaction.Triggers>
                                                                </Grid>

                                                                <Grid x:Name="appearanceItemsPanel">
                                                                    <Grid.Tag>
                                                                        <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                            <Binding ElementName="AppearanceTabNavigator" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                            <Binding ElementName="appearanceTabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>
                                                                            <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                        </MultiBinding>
                                                                    </Grid.Tag>

                                                                    <Grid.RenderTransform>
                                                                        <TranslateTransform X="{Binding ElementName=appearanceItemsPanel,Path=Tag}" Y="0"/>
                                                                    </Grid.RenderTransform>

                                                                    <Grid.Resources>
                                                                        <Storyboard x:Key="ScrollAppearanceTabsAnimation">
                                                                            <DoubleAnimation Storyboard.TargetName="appearanceItemsPanel" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource TabsSlideAnimationDuration}"
                                                                                AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=appearanceItemsPanel,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                        </Storyboard>
                                                                    </Grid.Resources>

                                                                    <b:Interaction.Triggers>
                                                                        <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=AppearanceTabNavigator}">
                                                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource ScrollAppearanceTabsAnimation}"/>
                                                                        </b:PropertyChangedTrigger>
                                                                    </b:Interaction.Triggers>
                                                                    <ItemsPresenter/>
                                                                </Grid>
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </ListBox.Template>
                                                    
                                                    <ListBox.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <StackPanel IsItemsHost="True" Orientation="Horizontal"/>
                                                        </ItemsPanelTemplate>
                                                    </ListBox.ItemsPanel>

                                                    <ListBox.ItemContainerStyle>
                                                        <Style TargetType="ListBoxItem">
                                                            <Setter Property="Template" Value="{StaticResource appearanceTabTemplate2}"/>
                                                        </Style>
                                                    </ListBox.ItemContainerStyle>



                                                    <ListBoxItem x:Name="generalTab" Tag="general" Content="{Binding Source=h4c12a52dgcd71g43b9ga266gf506b54b0c55, Converter={StaticResource TranslatedStringConverter}}"/>
                                                    <ListBoxItem x:Name="faceTab" Tag="face" Content="{Binding Source=h1cb3665cgbe61g4230g8861g9bbfa408442b, Converter={StaticResource TranslatedStringConverter}}"/>
                                                    <ListBoxItem x:Name="hairTab" Tag="hair" Content="{Binding Source=h64935fcfg6ce0g4110g919cg15e8a57601b9, Converter={StaticResource TranslatedStringConverter}}" Visibility="{Binding SelectableHair.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                                                    <ListBoxItem x:Name="featuresTab" Tag="features" Content="{Binding Source=h97cb756egd22dg488aga292g7cd93aeaaa6e, Converter={StaticResource TranslatedStringConverter}}"/>
                                                    <ListBoxItem x:Name="hornsTab" Tag="horns" Content="{Binding Source=h1e2fea14g1a4fg4567ga286g8c4162b78d6e_14, Converter={StaticResource TranslatedStringConverter}}" Visibility="{Binding SelectableHorns.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                                                    <ListBoxItem x:Name="makeupTab" Tag="makeup" Content="{Binding Source=hbbddf3e9g352fg461fg8761gbb5256ebd9c4, Converter={StaticResource TranslatedStringConverter}}"/>
                                                    <ListBoxItem x:Name="accessoriesTab" Tag="accessories" Content="{Binding Source=hf8efcfc3g3463g4154g87deg839d6f7969da, Converter={StaticResource TranslatedStringConverter}}"/>
                                                    <ListBoxItem x:Name="passiveFeaturesTab" Tag="passivefeatures" Content="{Binding Source=h7572d825gd782g43a5g90aag7f5d814a5f1a, Converter={StaticResource TranslatedStringConverter}}" Visibility="Collapsed" />
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="SelectionChanged">
                                                            <b:Interaction.Behaviors>
                                                                <b:ConditionBehavior>
                                                                    <b:ConditionalExpression>
                                                                        <b:ComparisonCondition LeftOperand="{Binding ElementName=appearanceTabs, Path=SelectedIndex}" Operator="NotEqual" RightOperand="-1"/>
                                                                    </b:ConditionalExpression>
                                                                </b:ConditionBehavior>
                                                            </b:Interaction.Behaviors>
                                                            <b:ChangePropertyAction TargetName="appearanceTabs" PropertyName="Tag" Value="{Binding SelectedIndex, ElementName=appearanceTabs}" />
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>
                                                </ListBox>

                                            </Grid>

                                            <!-- New Daisy Tabs System -->
                                            <ListBox x:Name="daisyTabs" VerticalAlignment="Center" SelectedIndex="0" Visibility="Collapsed" Height="{Binding ElementName=gameplayTabs, Path=ActualHeight}" Width="{Binding ElementName=gameplayTabs, Path=ActualWidth}">
                                                <ListBox.Template>
                                                    <ControlTemplate TargetType="ListBox">
                                                        <Grid x:Name="templateRoot">
                                                            <b:Interaction.Behaviors>
                                                                <ls:SubListBoxBehavior x:Name="DaisyTabNavigator" RootListBox="{Binding RelativeSource={RelativeSource TemplatedParent}}" DoPrevious="{Binding ElementName=prevTabButton, Path=IsPressed}" DoNext="{Binding ElementName=nextTabButton, Path=IsPressed}"/>
                                                            </b:Interaction.Behaviors>

                                                            <!-- Daisy backplate -->
                                                            <Grid x:Name="daisyBackplate" Width="{Binding ElementName=DaisyTabNavigator, Path=BackplateWidth}" MinWidth="{Binding ElementName=DaisyTabNavigator, Path=RootListBox.SelectedItem.ActualWidth}"
                                                                  Height="{StaticResource TabsPanelHeight}" HorizontalAlignment="Left" VerticalAlignment="Top" Visibility="Visible">
                                                                <Grid.Tag>
                                                                    <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                        <Binding ElementName="DaisyTabNavigator" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                        <Binding ElementName="daisyTabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>
                                                                        <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                        <Binding ElementName="DaisyTabNavigator" Path="BackplateOffset"/>
                                                                    </MultiBinding>
                                                                </Grid.Tag>

                                                                <Grid.Background>
                                                                    <LinearGradientBrush Opacity="1.0" StartPoint="0,0" EndPoint="0,1">
                                                                        <GradientStop Offset="0" Color="{StaticResource transparentBlack}"/>
                                                                        <GradientStop Offset="0.5" Color="#70af8768"/>
                                                                        <GradientStop Offset="1.0" Color="#b0af8768" />
                                                                    </LinearGradientBrush>
                                                                </Grid.Background>

                                                                <Grid.RenderTransform>
                                                                    <TranslateTransform X="{Binding ElementName=daisyBackplate,Path=Tag}" Y="0"/>
                                                                </Grid.RenderTransform>

                                                                <Grid.Resources>
                                                                    <Storyboard x:Key="SlideDaisyBackplateAnimation">
                                                                        <DoubleAnimation Storyboard.TargetName="daisyBackplate" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource BackplateSlideAnimationDuration}"
                                                                            AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=daisyBackplate,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                    </Storyboard>
                                                                </Grid.Resources>

                                                                <b:Interaction.Triggers>
                                                                    <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=DaisyTabNavigator}">
                                                                        <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource SlideDaisyBackplateAnimation}"/>
                                                                        <ls:LSControlStoryboard ControlStoryboardOption="Play" >
                                                                            <ls:LSControlStoryboard.Storyboard>
                                                                                <Storyboard x:Name="initialDaisyBackplateWidthSetting" Duration="0:0:0.1">
                                                                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="daisyBackplate">
                                                                                        <DiscreteObjectKeyFrame KeyTime="0:0:0.1" Value="{x:Static Visibility.Visible}"/>
                                                                                    </ObjectAnimationUsingKeyFrames>
                                                                                </Storyboard>
                                                                            </ls:LSControlStoryboard.Storyboard>
                                                                        </ls:LSControlStoryboard>
                                                                    </b:PropertyChangedTrigger>
                                                                </b:Interaction.Triggers>
                                                            </Grid>

                                                            <Grid x:Name="daisyItemsPanel">
                                                                <Grid.Tag>
                                                                    <MultiBinding Converter="{StaticResource AddMultipleConverter}">
                                                                        <Binding ElementName="DaisyTabNavigator" Path="SelectedOffset" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-1"/>
                                                                        <Binding ElementName="daisyTabSelector" Path="Width" Converter="{StaticResource MultiplierConverter}" ConverterParameter="-0.5"/>
                                                                        <Binding ElementName="tabBarClipper" Path="Tag"/>
                                                                    </MultiBinding>
                                                                </Grid.Tag>

                                                                <Grid.RenderTransform>
                                                                    <TranslateTransform X="{Binding ElementName=daisyItemsPanel,Path=Tag}" Y="0"/>
                                                                </Grid.RenderTransform>

                                                                <Grid.Resources>
                                                                    <Storyboard x:Key="ScrollDaisyTabsAnimation">
                                                                        <DoubleAnimation Storyboard.TargetName="daisyItemsPanel" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)" Duration="{StaticResource TabsSlideAnimationDuration}"
                                                                            AccelerationRatio="0.25" DecelerationRatio="0.25" To="{Binding ElementName=daisyItemsPanel,Path=Tag}" FillBehavior="HoldEnd"/>
                                                                    </Storyboard>
                                                                </Grid.Resources>

                                                                <b:Interaction.Triggers>
                                                                    <b:PropertyChangedTrigger Binding="{Binding Path=SelectedOffset, ElementName=DaisyTabNavigator}">
                                                                        <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource ScrollDaisyTabsAnimation}"/>
                                                                    </b:PropertyChangedTrigger>
                                                                </b:Interaction.Triggers>
                                                                <ItemsPresenter/>
                                                            </Grid>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </ListBox.Template>
                                                
                                                <ListBox.ItemsPanel>
                                                    <ItemsPanelTemplate>
                                                        <StackPanel IsItemsHost="True" Orientation="Horizontal"/>
                                                    </ItemsPanelTemplate>
                                                </ListBox.ItemsPanel>

                                                <ListBox.ItemContainerStyle>
                                                    <Style TargetType="ListBoxItem">
                                                        <Setter Property="Template" Value="{StaticResource daisyTabTemplate2}"/>
                                                    </Style>
                                                </ListBox.ItemContainerStyle>

                                                <ListBoxItem x:Name="raceDaisyTab" Tag="race" Content="{Binding Source=hadf27237ge191g4922ga84cg055b984c9b1f, Converter={StaticResource TranslatedStringConverter}}"/>
                                                <ListBoxItem x:Name="headDaisyTab" Tag="head" Content="{Binding Source=h1cb3665cgbe61g4230g8861g9bbfa408442b, Converter={StaticResource TranslatedStringConverter}}"/>
                                                <ListBoxItem x:Name="hairDaisyTab" Tag="hair" Content="{Binding Source=h64935fcfg6ce0g4110g919cg15e8a57601b9, Converter={StaticResource TranslatedStringConverter}}"/>
                                                <ListBoxItem x:Name="featuresDaisyTab" Tag="features" Content="{Binding Source=h97cb756egd22dg488aga292g7cd93aeaaa6e, Converter={StaticResource TranslatedStringConverter}}"/>
                                                <ListBoxItem x:Name="hornsDaisyTab" Tag="horns" Content="{Binding Source=h1e2fea14g1a4fg4567ga286g8c4162b78d6e_14, Converter={StaticResource TranslatedStringConverter}}" Visibility="{Binding SelectableHorns.Count, Converter={StaticResource CountToVisibilityConverter}}"/>
                                                <ListBoxItem x:Name="makeupDaisyTab" Tag="makeup" Content="{Binding Source=hbbddf3e9g352fg461fg8761gbb5256ebd9c4, Converter={StaticResource TranslatedStringConverter}}"/>
                                                <ListBoxItem x:Name="accessoriesDaisyTab" Tag="accessories" Content="{Binding Source=hf8efcfc3g3463g4154g87deg839d6f7969da, Converter={StaticResource TranslatedStringConverter}}"/>
                                                
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="SelectionChanged">
                                                        <b:Interaction.Behaviors>
                                                            <b:ConditionBehavior>
                                                                <b:ConditionalExpression>
                                                                    <b:ComparisonCondition LeftOperand="{Binding ElementName=daisyTabs, Path=SelectedIndex}" Operator="NotEqual" RightOperand="-1"/>
                                                                </b:ConditionalExpression>
                                                            </b:ConditionBehavior>
                                                        </b:Interaction.Behaviors>
                                                        <b:ChangePropertyAction TargetName="daisyTabs" PropertyName="Tag" Value="{Binding SelectedIndex, ElementName=daisyTabs}" />
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ListBox>

                                            <Grid x:Name="selectedDaisyTabUnderline" HorizontalAlignment="Left" Margin="102,-56,0,0" Width="600" Visibility="Collapsed">
                                                <!-- Daisy underline positioned to align with daisy tabs -->
                                                <ls:LSNineSliceImage x:Name="daisyTabSelector" Style="{StaticResource tabSelectorStyle}" Width="0" Margin="0,-20,0,20"/>
                                            </Grid>

                                            <Grid x:Name="selectedTabUnderline" HorizontalAlignment="Left" Margin="102,-56,0,0" Width="600">
                                                <!-- Variable width element, always centered in surrounding Grid -->
                                                <!-- Width for animation -->
                                                <ls:LSNineSliceImage x:Name="tabSelector" Style="{StaticResource tabSelectorStyle}" Width="0" Margin="0,-20,0,20"/>
                                            </Grid>

                                            <Grid x:Name="selectedAppearanceTabUnderline" HorizontalAlignment="Left" Margin="102,-56,0,0" Width="600" Visibility="Collapsed">
                                                <!-- Appearance underline positioned to align with first appearance tab -->
                                                <ls:LSNineSliceImage x:Name="appearanceTabSelector" Style="{StaticResource tabSelectorStyle}" Width="0" Margin="0,-20,0,20"/>
                                            </Grid>


                                        </StackPanel>

                                        <StackPanel x:Name="tabBarButtons" Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="50,0,0,0">
                                            <ls:LSButton x:Name="prevTabButton" 
                                                         IsEnabled="{Binding ElementName=SubListBoxHelper,Path=HasPrevious}"
                                                         ContentTemplate="{StaticResource ControllerButtonHintImageOnly}"
                                                         Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UITabPrev, Converter={StaticResource FindInputEventConverter}}"
                                                         BoundEvent="UITabPrev"
                                                         Margin="-20,0,-20,0">
                                                <ls:LSButton.Style>
                                                    <Style TargetType="ls:LSButton" BasedOn="{StaticResource {x:Type ls:LSButton}}">
                                                        <Style.Triggers>
                                                            <!-- Bind to AppearanceTabNavigator when in appearance mode -->
                                                            <DataTrigger Binding="{Binding ElementName=modeController, Path=Tag}" Value="appearance">
                                                                <Setter Property="IsEnabled" Value="{Binding ElementName=AppearanceTabNavigator,Path=HasPrevious}"/>
                                                            </DataTrigger>
                                                            <!-- Bind to DaisyTabNavigator when in daisy mode -->
                                                            <DataTrigger Binding="{Binding CharacterCreationStep}" Value="Companion">
                                                                <Setter Property="IsEnabled" Value="{Binding ElementName=DaisyTabNavigator,Path=HasPrevious}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ls:LSButton.Style>
                                            </ls:LSButton>
                                            <ls:LSButton x:Name="nextTabButton" 
                                                         IsEnabled="{Binding ElementName=SubListBoxHelper,Path=HasNext}"
                                                         ContentTemplate="{StaticResource ControllerButtonHintImageOnly}"
                                                         Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UITabNext, Converter={StaticResource FindInputEventConverter}}"
                                                         BoundEvent="UITabNext"
                                                         Margin="-20,0,-20,0">
                                                <ls:LSButton.Style>
                                                    <Style TargetType="ls:LSButton" BasedOn="{StaticResource {x:Type ls:LSButton}}">
                                                        <Style.Triggers>
                                                            <!-- Bind to AppearanceTabNavigator when in appearance mode -->
                                                            <DataTrigger Binding="{Binding ElementName=modeController, Path=Tag}" Value="appearance">
                                                                <Setter Property="IsEnabled" Value="{Binding ElementName=AppearanceTabNavigator,Path=HasNext}"/>
                                                            </DataTrigger>
                                                            <!-- Bind to DaisyTabNavigator when in daisy mode -->
                                                            <DataTrigger Binding="{Binding CharacterCreationStep}" Value="Companion">
                                                                <Setter Property="IsEnabled" Value="{Binding ElementName=DaisyTabNavigator,Path=HasNext}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </ls:LSButton.Style>
                                            </ls:LSButton>
                                        </StackPanel>



                                        <ls:LSNineSliceImage x:Name="InvalidAppearanceError" VerticalAlignment="Bottom" HorizontalAlignment="Center" Visibility="Collapsed" Style="{StaticResource MissingRequirementsErrorStyle}" Margin="0,0,0,430">
                                            <TextBlock Foreground="{StaticResource CCTabToDo}" Text="{Binding AppearanceValidationError}" VerticalAlignment="Center" />
                                        </ls:LSNineSliceImage>

                                        <ls:LSNineSliceImage x:Name="MissingRequirementsMainError" VerticalAlignment="Top" HorizontalAlignment="Right" Visibility="Collapsed" Style="{StaticResource MissingRequirementsErrorStyle}" ContentTemplate="{StaticResource MissingRequirementsErrorTemplate}" Margin="0,140,46,0"   Content=""/>

                                            <ContentControl x:Name="gotoNamingButton" Template="{StaticResource buttonBackplateTemplate}" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,148" >
                                            <ls:LSButton IsEnabled="{Binding IsCharacterCompleteExceptName}"
                                                        ContentTemplate="{StaticResource ControllerButtonHint}" 
                                                        Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UIDelete, Converter={StaticResource FindInputEventConverter}}" 
                                                        BoundEvent="UIDelete" 
                                                        Tag="{Binding Source=h29f5143dgf3f8g4185ga82ag411205073b03,Converter={StaticResource TranslatedStringConverter}}">
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="Click">
                                                        <b:ChangePropertyAction TargetName="gamePlayPage" PropertyName="Visibility" Value="Collapsed" />
                                                        <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Visible" />
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ls:LSButton>
                                        </ContentControl>

                                        <!-- VentureForthButton for Daisy Mode -->
                                        <ContentControl x:Name="ventureForthButton" Template="{StaticResource buttonBackplateTemplate}" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,148" Visibility="Collapsed">
                                            <ls:LSButton Style="{StaticResource ControllerHoldButtonStyle}" 
                                                        Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='UIDelete'}" 
                                                        Tag="{Binding Source='h06b74424gf3bdg4b6cgbe63g84b32198e162', Converter={StaticResource TranslatedStringConverter}}" 
                                                        Command="{Binding DataContext.FinishCreating, RelativeSource={RelativeSource AncestorType={x:Type ls:UIWidget}}}" 
                                                        SoundID="UI_HUD_CC_VentureForth" 
                                                        Margin="2,0,0,0">
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="LSButtonReleased">
                                                        <ls:LSPlaySound Sound="UI_HUD_CC_VentureForth_Controller_Release"/>
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ls:LSButton>
                                        </ContentControl>

                                    </Grid>

                                </Grid>

                                <Grid x:Name="summary" Visibility="Collapsed" HorizontalAlignment="Right">
                                    <b:Interaction.Triggers>
                                        <b:DataTrigger Binding="{Binding ElementName=summary, Path=IsVisible}" Value="False">
                                            <b:ChangePropertyAction TargetName="leftSidePanels" PropertyName="IsEnabled" Value="True" />
                                            <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="False" />
                                            <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Visible" />
                                            <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Hidden" />
                                            <b:ChangePropertyAction TargetName="bottomButtons" PropertyName="Template" Value="{StaticResource StandardBottomButtonsTemplate2}"/>
                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=leftSidePanels}"/>
                                            <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource unfocusSummaryPanelStoryboard}"/>
                                        </b:DataTrigger>
                                    </b:Interaction.Triggers>

                                    <Rectangle x:Name="summaryBackground" HorizontalAlignment="Right" Width="{StaticResource summaryPanelBackgroundWidth}" RenderTransformOrigin="1,0.5" Fill="{StaticResource RightSideShadingBrush}" OpacityMask="{StaticResource OpacityMaskShadingBrush}">
                                        <Rectangle.RenderTransform>
                                            <ScaleTransform/>
                                        </Rectangle.RenderTransform>
                                    </Rectangle>

                                    <Grid x:Name="summaryAnimPanel" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,230,34,0">
                                        <Grid.RenderTransform>
                                            <TranslateTransform X="0"/>
                                        </Grid.RenderTransform>

                                        <Control x:Name="summaryPanel" IsEnabled="False" ls:MoveFocus.IsMoveFocusScope="True" Template="{StaticResource summaryPanelTemplate}"  HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,16,0"/>

                                        <ls:LSInputBinding x:Name="backFromFocusedSummary" IsEnabled="{Binding IsEnabled, ElementName=summaryPanel}" BoundEvent="UICancel">
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="LSInputBindingReleased" >
                                                    <b:ChangePropertyAction TargetName="leftSidePanels" PropertyName="IsEnabled" Value="True" />
                                                    <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="False" />
                                                    <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Visible" />
                                                    <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                    <b:ChangePropertyAction TargetName="bottomButtons" PropertyName="Template" Value="{StaticResource StandardBottomButtonsTemplate2}"/>
                                                    <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=leftSidePanels}"/>
                                                    <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource unfocusSummaryPanelStoryboard}"/>
                                                </b:EventTrigger>
                                                <b:EventTrigger EventName="LSInputBindingPressed">
                                                    <ls:LSPlaySound Sound="UI_DefaultButton_Click"/>
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                        </ls:LSInputBinding>

                                        <ls:LSButton x:Name="focusSummaryPanelButton" 
                                                     Tag=" " 
                                                     ContentTemplate="{StaticResource ControllerButtonHint}"
                                                     Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='ToggleSummaryFocus'}"
                                                     BoundEvent="ToggleSummaryFocus" 
                                                     HorizontalAlignment="Right"
                                                     VerticalAlignment="Top">
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="Click" >
                                                    <b:ChangePropertyAction TargetName="leftSidePanels" PropertyName="IsEnabled" Value="False" />
                                                    <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="True" />
                                                    <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                    <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Visible" />
                                                    <b:ChangePropertyAction TargetName="bottomButtons" PropertyName="Template" Value="{StaticResource SummaryBottomButtonsTemplate}"/>
                                                    <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=summaryPanel}"/>
                                                    <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource focusSummaryPanelStoryboard}"/>
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                        </ls:LSButton>

                                    </Grid>
                                </Grid>

                                <StackPanel x:Name="bottomButtonsHolder" Margin="0,0,24,56" Style="{StaticResource ButtonHint.Container.Right}">
                                    <Control x:Name="bottomButtons" Template="{StaticResource StandardBottomButtonsTemplate2}"/>
                                    
                                    <!-- Daisy mode back button -->
                                    <ls:LSButton x:Name="daisyBackButton" Visibility="Collapsed"
                                                 ContentTemplate="{StaticResource ControllerButtonHint}" 
                                                 Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UICreate, Converter={StaticResource FindInputEventConverter}}" 
                                                 BoundEvent="UICreate" 
                                                 Tag="{Binding Source=h77fec760g866dg4e47g8e81g467c9c05e447,Converter={StaticResource TranslatedStringConverter}}" 
                                                 Margin="50,0,0,0">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click">
                                                <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Naming"/>
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>
                                </StackPanel>

                            </Grid>

                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding IsCharacterCompleteExceptName}" Value="False">
                                    <Setter TargetName="MissingRequirementsMainError" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding AppearanceValidationError, Converter={StaticResource NullToBoolFalseConverter}, ConverterParameter='EmptyString', FallbackValue=False}" Value="True">
                                    <Setter TargetName="InvalidAppearanceError" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding SelectedOrigin.IsLockedAppearance}" Value="True">
                                    <Setter TargetName="appearanceContentsPanel" Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>

                                <!-- Split Screen variation -->
                                <DataTrigger Binding="{Binding Layout}" Value="Common">
                                    <Setter TargetName="leftSidePanels" Property="Margin" Value="170,140,0,0"/>
                                    <Setter TargetName="tabBarClipper" Property="Tag" Value="580"/>
                                    <Setter TargetName="tabBar" Property="Margin" Value="226,0,0,0"/>
                                    <Setter TargetName="selectedTabUnderline" Property="Margin" Value="252,-54,0,0"/>
                                    <Setter TargetName="appearancePanel" Property="Height" Value="{StaticResource appearancePanelHeight}"/>
                                    <Setter TargetName="appearancePanel" Property="Margin" Value="0,212,200,0"/>
                                    <Setter TargetName="leftSideShading" Property="Width" Value="{StaticResource leftSidePanelBackgroundWidth}"/>
                                    <Setter TargetName="gameplayPanel" Property="Height" Value="{StaticResource gameplayPanelHeight}" />
                                    <Setter TargetName="appearanceContentsPanel" Property="Height" Value="{StaticResource gameplayPanelHeight}" />
                                    <Setter TargetName="appearanceContentsPanel" Property="Width" Value="{StaticResource gameplayPanelWidth}" />
                                    <Setter TargetName="daisyContentsPanel" Property="Height" Value="{StaticResource gameplayPanelHeight}" />
                                    <Setter TargetName="daisyContentsPanel" Property="Width" Value="{StaticResource gameplayPanelWidth}" />
                                    <Setter TargetName="MissingRequirementsMainError" Property="HorizontalAlignment" Value="Center" />
                                    <Setter TargetName="MissingRequirementsMainError" Property="VerticalAlignment" Value="Bottom" />
                                    <Setter TargetName="MissingRequirementsMainError" Property="Margin" Value="0,0,0,300" />

                                    <Setter TargetName="bottomButtonsHolder" Property="Margin" Value="0,0,90,56"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding IsEnabled, ElementName=leftSidePanels}" Value="False">
                                    <Setter TargetName="gotoNamingButton" Property="IsEnabled" Value="False"/>
                                </DataTrigger>

                                <!-- Common layout with appearance mode -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding Layout}" Value="Common"/>
                                        <Condition Binding="{Binding ElementName=modeController, Path=Tag}" Value="appearance"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="selectedAppearanceTabUnderline" Property="Margin" Value="252,-54,0,0" />
                                </MultiDataTrigger>

                                <!-- Common layout with daisy mode -->
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding Layout}" Value="Common"/>
                                        <Condition Binding="{Binding CharacterCreationStep}" Value="Companion"/>
                                    </MultiDataTrigger.Conditions>
                                    <Setter TargetName="selectedDaisyTabUnderline" Property="Margin" Value="252,-54,0,0" />
                                </MultiDataTrigger>

                                <DataTrigger Binding="{Binding Layout}" Value="Common">
                                    <Setter TargetName="summary" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Tag, ElementName=summary}" Value="ShowIfPossible">
                                    <Setter TargetName="summary" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="summary" Property="Tag" Value=""/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Tag, ElementName=summary}" Value="HideIfPossible">
                                    <Setter TargetName="summary" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="summary" Property="Tag" Value=""/>
                                </DataTrigger>

                                <!--
                                Gameplay Panel Content 
                                -->

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="origin">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                <Grid>
                                                  <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                  </Grid.RowDefinitions>
                                                  <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                  </Grid.ColumnDefinitions>
                                                  <b:Interaction.Triggers>
                                                      <b:EventTrigger EventName="Loaded">
                                                          <b:ChangePropertyAction TargetName="bottomButtons" PropertyName="Template" Value="{StaticResource StandardBottomButtonsTemplate2}"/>
                                                      </b:EventTrigger>
                                                  </b:Interaction.Triggers>

                                                      <Control Template="{StaticResource setOverviewCamera}"/>

                                                      <StackPanel x:Name="originHeader" Orientation="Horizontal" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource originHeaderTemplate}"/>
                                                      </StackPanel>

                                                      <!-- Used to set the SelectedOrigin back to Custom Origin -->
                                                      <ListBox DockPanel.Dock="Top" x:Name="allOrigins" Visibility="Collapsed" ItemsSource="{Binding SelectableOrigins}" SelectedItem="{Binding SelectedOrigin}"/>

                                                      <Control DockPanel.Dock="Top" x:Name="originControls" Template="{StaticResource originControlsTemplate}" Grid.Row="1"/>

                                                    <Control Grid.Row="2" Template="{StaticResource HUI_SelectorClosingTemplate}"/>

                                                    <DockPanel Grid.Row="3">
                                                        <ContentControl x:Name="PlayIntroduction" DockPanel.Dock="Top" Template="{StaticResource buttonBackplateTemplate}" HorizontalAlignment="Center" Visibility="Collapsed">
                                                            <ls:LSButton ContentTemplate="{StaticResource ControllerButtonHint}"
                                                                      Tag="{Binding Source='h0a5097d1g8471g4a05ga294gf9549ecf2151', Converter={StaticResource TranslatedStringConverter}}" 
                                                                      Command="{Binding PlayOriginTimeline}"
                                                                      Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UIAccept, Converter={StaticResource FindInputEventConverter}}"
                                                                      BoundEvent="UIAccept"
                                                                      TapTime="{StaticResource DefaultButtonTapTime}"
                                                                      Margin="0,0,0,0"/>
                                                        </ContentControl>

                                                        <ScrollViewer DockPanel.Dock="Top" Style="{StaticResource gameplayPanelScrollViewerStyle}"
                                                                      VerticalScrollBarVisibility="Auto" Margin="0,0,0,0" Height="700" x:Name="customControls" Visibility="Collapsed">

                                                                <StackPanel Style="{StaticResource gameplayScrolledStackPanelStyle}">
                                                                    <Control x:Name="bodyType" Template="{StaticResource BodyTypeChoice}" HorizontalAlignment="Center" Margin="0,0,0,0"/>
                                                                    <Control x:Name="identity" Template="{StaticResource IdentityChoice}" HorizontalAlignment="Center" Margin="0,0,0,0"/>

                                                                    <!-- Randomisation controls -->
                                                                    <Control x:Name="RandomizeCharacterOrigins" Template="{StaticResource ChangeRandomCharacterCarouselTemplate}" Visibility="Collapsed" Margin="0,47,0,0"/>

                                                                </StackPanel>
                                                        </ScrollViewer>
                                                    </DockPanel>
                                                    <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding SelectedOrigin.Description}" />

                                                  </Grid>
                                                </DockPanel>
                                                <ControlTemplate.Triggers>
                                                    <MultiDataTrigger>
                                                      <MultiDataTrigger.Conditions>
                                                          <Condition Binding="{Binding SelectedOrigin.IsLockedAppearance}" Value="True"/>
                                                          <Condition Binding="{Binding SelectedOrigin.IsCustom}" Value="False"/>
                                                      </MultiDataTrigger.Conditions>
                                                          <Setter TargetName="customControls" Property="Visibility" Value="Collapsed"/>
                                                    </MultiDataTrigger>
                                                    <DataTrigger Binding="{Binding SelectedOrigin.IsCustom}" Value="True">
                                                        <Setter TargetName="PlayIntroduction" Property="Visibility" Value="Collapsed"/>
                                                        <Setter TargetName="RandomizeCharacterOrigins" Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding SelectedOrigin.IsLockedAppearance}" Value="False">
                                                        <Setter TargetName="customControls" Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding SelectedOrigin.IsCustom}" Value="False">
                                                        <Setter TargetName="PlayIntroduction" Property="Visibility" Value="Visible"/>
                                                        <Setter TargetName="RandomizeCharacterOrigins" Property="Visibility" Value="Collapsed"/>
                                                    </DataTrigger>

                                                    <DataTrigger Binding="{Binding SelectedRace}" Value="{x:Null}">
                                                        <Setter TargetName="bodyType" Property="Visibility" Value="Hidden"/>
                                                    </DataTrigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="race">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                              <DockPanel LastChildFill="True">
                                                <Grid>
                                                  <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                  </Grid.RowDefinitions>
                                                  <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="*" />
                                                  </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                    <StackPanel x:Name="raceCarouselAndDescription" Orientation="Horizontal" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                        <Control Template="{StaticResource raceSelectionTemplate}"/>
                                                    </StackPanel>

                                                    <Control Template="{StaticResource raceProgressionsTemplate}" Grid.Column="0" Grid.Row="1"/>

                                                  <Control Template="{StaticResource raceDescriptionTemplate}" Grid.Column="1" Grid.RowSpan="2" DockPanel.Dock="Top"  Margin="-250,200,0,0"/>
                                                </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="subrace">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                              <DockPanel LastChildFill="True">
                                                <Grid>
                                                  <Grid.RowDefinitions>
                                                    <RowDefinition Height="Auto" />
                                                    <RowDefinition Height="*" />
                                                  </Grid.RowDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                    <StackPanel x:Name="raceCarouselAndDescription" Orientation="Horizontal" DockPanel.Dock="Top"  Grid.Row="0">
                                                      <Control Template="{StaticResource subRaceSelectionTemplate}"/>
                                                    </StackPanel>

                                                    <Control Template="{StaticResource subRaceProgressionsTemplate}"  Grid.Row="1"/>
                                                </Grid>
                                              </DockPanel>

                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="class">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel  LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto" />
                                                      <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                      <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="classCarouselAndDescription" Orientation="Horizontal" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource classSelectionTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource classProgressionsTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                      <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding SelectedClass.Description}" />
                                                    </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="subclass">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel  LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto" />
                                                      <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                      <StackPanel x:Name="subclassCarouselAndDescription" Orientation="Horizontal" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource subClassSelectionTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource subClassProgressionsTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                      <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding SelectedSubClass.Description}" />
                                                    </Grid>
                                                </DockPanel>

                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="deity">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto" />
                                                      <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                    <StackPanel x:Name="deityCarouselAndDescription" Orientation="Horizontal" VerticalAlignment="Stretch"  DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                        <Control Template="{StaticResource deitySelectionTemplate}"/>
                                                    </StackPanel>

                                                    <Control Template="{StaticResource deityProgressionsTemplate}" Grid.Column="0" Grid.Row="1"/>

                                                      <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding SelectedDeity.Description}" />
                                                  </Grid>
                                              </DockPanel>

                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="spellprep">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto" />
                                                      <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                    <StackPanel x:Name="spellPreperationScreen" Orientation="Horizontal" VerticalAlignment="Stretch"  DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource HUI_SpellPrepTemplate}"/>
                                                    </StackPanel>

                                                    <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                    <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding Source='he47d6cc7g50c3g4ab6g9027g2c54a173db29', Converter={StaticResource TranslatedStringConverter}}" /> 


                                                  </Grid>
                                                </DockPanel>
                                          </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="background">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Grid.ColumnDefinitions>
                                                      <ColumnDefinition Width="Auto" />
                                                      <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <b:Interaction.Triggers>
                                                        <b:EventTrigger EventName="Loaded">
                                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                        </b:EventTrigger>
                                                    </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="backgroundCarouselAndDescription" Orientation="Horizontal" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource backgroundSelectionTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource backgroundProgressionsTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                      <ContentControl Template="{StaticResource HUI_DescriptionTemplate}" 
                                                                      HorizontalAlignment="Left" DockPanel.Dock="Top" Grid.Column="1" Grid.RowSpan="2"
                                                                      Tag="{Binding SelectedBackground.Description}" />
                                                    </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="feat">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                      <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                      </Grid.RowDefinitions>
                                                      <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                      </Grid.ColumnDefinitions>
                                                      <b:Interaction.Triggers>
                                                          <b:EventTrigger EventName="Loaded">
                                                              <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                          </b:EventTrigger>
                                                      </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="featSelectionPanelTemplate" Orientation="Horizontal" VerticalAlignment="Stretch"  DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource featSelectionTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                  </Grid>
                                                </DockPanel>

                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="featdetails">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                      <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="*" />
                                                      </Grid.RowDefinitions>
                                                      <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                      </Grid.ColumnDefinitions>
                                                      <b:Interaction.Triggers>
                                                          <b:EventTrigger EventName="Loaded">
                                                              <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                          </b:EventTrigger>
                                                      </b:Interaction.Triggers>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="featDetailsPanelTemplate" Orientation="Horizontal" VerticalAlignment="Stretch"  DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource featDetailsTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>
                                                  </Grid>
                                                </DockPanel>

                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="ability">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>

                                                    <DockPanel VerticalAlignment="Top">
                                                        <b:Interaction.Triggers>
                                                            <b:EventTrigger EventName="Loaded">
                                                                <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                                            </b:EventTrigger>
                                                        </b:Interaction.Triggers>

                                                        <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                        <Control Template="{StaticResource abilitySelectionTemplate}"/>

                                                    </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>


                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="raceskills">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="backgroundCarouselAndDescription" Orientation="Horizontal" VerticalAlignment="Stretch" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource raceSkillProficiencyPanelTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>

                                                    </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>                                
                                
                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="skills">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>

                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                      <StackPanel x:Name="backgroundCarouselAndDescription" Orientation="Horizontal" VerticalAlignment="Stretch" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                          <Control Template="{StaticResource skillProficiencyPanelTemplate}"/>
                                                      </StackPanel>

                                                      <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>

                                                    </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=gameplayTabs, Path=SelectedItem.Tag}" Value="expertise">
                                    <Setter TargetName="gameplayPanel" Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate>
                                                <DockPanel LastChildFill="True">
                                                  <Grid>
                                                    <Grid.RowDefinitions>
                                                      <RowDefinition Height="Auto" />
                                                      <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>
                                                    <Control Template="{StaticResource setGameplayCameraOffsets}"/>

                                                    <StackPanel x:Name="backgroundCarouselAndDescription" Orientation="Horizontal" VerticalAlignment="Stretch" DockPanel.Dock="Top" Grid.Column="0" Grid.Row="0">
                                                      <Control Template="{StaticResource skillExpertisePanelTemplate}"/>
                                                    </StackPanel>

                                                    <Control Template="{StaticResource HUI_SelectorClosingTemplate}" Grid.Column="0" Grid.Row="1"/>

                                                  </Grid>
                                                </DockPanel>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>


                                <!-- Appearance mode for all layout types -->
                                <DataTrigger Binding="{Binding ElementName=modeController, Path=Tag}" Value="appearance">

                                    <!-- Hide the gameplay tabs and show appearance tabs -->
                                    <Setter TargetName="gameplayTabs" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="appearanceTabs" Property="Visibility" Value="Visible"/>
                                    
                                    <!-- Hide all gameplay content panels -->
                                    <Setter TargetName="gameplayPanel" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="gameplaySubPanel" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="appearanceContentsPanel" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="summary" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="summaryBackground" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Switch to dedicated appearance tab selector container -->
                                    <Setter TargetName="selectedTabUnderline" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="selectedAppearanceTabUnderline" Property="Visibility" Value="Visible"/>
                                    
                                    <!-- Set the appearance contents panel template - default to General when entering appearance mode -->
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource GeneralAppearanceTemplate}"/>

                                </DataTrigger>

                                <!-- Appearance Tab Specific DataTriggers -->
                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="general">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource GeneralAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="face">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource FaceAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="hair">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource HairAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="makeup">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource MakeupAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="accessories">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource AccessoriesAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="horns">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource HornsAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="features">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource FeaturesAppearanceTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=appearanceTabs, Path=SelectedItem.Tag}" Value="passivefeatures">
                                    <Setter TargetName="appearanceContentsPanel" Property="Template" Value="{StaticResource PassiveFeaturesAppearanceTemplate}"/>
                                </DataTrigger>

                                <!-- Show passiveFeaturesTab for Draconic Sorcerer -->
                                <DataTrigger Binding="{Binding SelectedSubClass.IsDraconicSorcerer}" Value="True">
                                    <Setter TargetName="passiveFeaturesTab" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                
                                <!-- Show passiveFeaturesTab when SelectableScales.Count > 0 -->
                                <DataTrigger Binding="{Binding SelectableScales.Count, Converter={StaticResource GreaterThanConverter}, ConverterParameter=0}" Value="True">
                                    <Setter TargetName="passiveFeaturesTab" Property="Visibility" Value="Visible"/>
                                </DataTrigger>

                                <!-- Daisy Tabs Mode - triggered by CharacterCreationStep -->
                                <DataTrigger Binding="{Binding CharacterCreationStep}" Value="Companion">
                                    <!-- Hide other tab systems -->
                                    <Setter TargetName="gameplayTabs" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="appearanceTabs" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="selectedTabUnderline" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="selectedAppearanceTabUnderline" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Show daisy systems -->
                                    <Setter TargetName="daisyTabs" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="selectedDaisyTabUnderline" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="daisyContentsPanel" Property="Visibility" Value="Visible"/>
                                    
                                    <!-- Hide other content panels -->
                                    <Setter TargetName="gameplayPanel" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="appearanceContentsPanel" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Hide summary in daisy mode -->
                                    <Setter TargetName="summary" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Hide the old daisy page list in daisy mode -->
                                    <Setter TargetName="daisyPage" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Hide mode controller in daisy mode -->
                                    <Setter TargetName="modeController" Property="Visibility" Value="Collapsed"/>
                                    
                                    <!-- Replace gotoNamingButton with VentureForthButton behavior -->
                                    <Setter TargetName="gotoNamingButton" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="ventureForthButton" Property="Visibility" Value="Visible"/>
                                    
                                    <!-- Show back button in daisy mode -->
                                    <Setter TargetName="daisyBackButton" Property="Visibility" Value="Visible"/>
                                    
                                    <!-- Hide toggle tooltips and nudity buttons during daisy mode -->
                                    <Setter TargetName="bottomButtons" Property="Template" Value="{StaticResource StandardBottomButtonsTemplate2}"/>
                                    
                                    <!-- Set the daisy contents panel template - default to Race when entering daisy mode -->
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource RaceDaisyTemplate}"/>

                                </DataTrigger>

                                <!-- Daisy Tab Specific DataTriggers -->
                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="race">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource RaceDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="head">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource HeadDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="hair">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource HairDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="features">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource FeaturesDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="makeup">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource MakeupDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="horns">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource HornsDaisyTemplate}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding ElementName=daisyTabs, Path=SelectedItem.Tag}" Value="accessories">
                                    <Setter TargetName="daisyContentsPanel" Property="Template" Value="{StaticResource AccessoriesDaisyTemplate}"/>
                                </DataTrigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Control.Template>
                </Control>

                <Control x:Name="namingPage" Visibility="Collapsed">
                    <Control.Template>
                        <ControlTemplate TargetType="Control">
                            <Grid>
                                <b:Interaction.Triggers>
                                    <b:DataTrigger Binding="{Binding ElementName=namingPage, Path=Visibility}" Value="Visible">
                                        <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Naming"/>
                                    </b:DataTrigger>
                                </b:Interaction.Triggers>

                                <Control Template="{StaticResource setNamingCamera}" Visibility="{Binding Visibility, ElementName=namingPage}"/>

                                <Rectangle x:Name="bottomShading" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Height="{StaticResource bottomBackgroundHeight}" Fill="{StaticResource BottomShadingBrush}"/>
                                
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,148">

                                    <b:Interaction.Triggers>
                                        <b:EventTrigger EventName="Loaded">
                                            <ls:SetMoveFocusAction TargetName="CharacterCreation_c"/>
                                        </b:EventTrigger>
                                    </b:Interaction.Triggers>

                                    <TextBlock x:Name="CharacterNameHeader" ls:TextBlockFormatter.SourceText="{Binding Source=hfc928d2ega3a9g420egbeb5g0b20ab704959, Converter={StaticResource TranslatedStringConverter}}" Style="{StaticResource PanelHeaderText}"/>

                                    <Control x:Name="textInputBox" Template="{StaticResource HUI_NamingBoxComponent}" Tag="{Binding Source='h5cd3cabag657ag4abfga33fg9b1b2808ee7f', Converter={StaticResource TranslatedStringConverter}}"/>

                                    <ContentPresenter x:Name="MissingRequirementsError" HorizontalAlignment="Center" Visibility="Collapsed" Margin="50,0,0,-20" ContentTemplate="{StaticResource MissingRequirementsErrorTemplate}" Content=""/>

                                    <ContentControl Template="{StaticResource buttonBackplateTemplate}" HorizontalAlignment="Center" Margin="50,0,0,0">

                                        <ls:LSButton x:Name="gotoDaisyButton"
                                                         ContentTemplate="{StaticResource ControllerButtonHint}" 
                                                         Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UIDelete, Converter={StaticResource FindInputEventConverter}}" 
                                                         BoundEvent="UIDelete" 
                                                         Tag="{Binding Source=h29f5143dgf3f8g4185ga82ag411205073b03,Converter={StaticResource TranslatedStringConverter}}">
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="Click">
                                                    <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Companion"/>
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                        </ls:LSButton>
                                    </ContentControl>

                                </StackPanel>

                                <!-- Naming Page Summary -->
                                <Grid x:Name="summary" Visibility="Collapsed" HorizontalAlignment="Right">
                                    <Rectangle x:Name="summaryBackground" HorizontalAlignment="Right" Width="{StaticResource summaryPanelBackgroundWidth}" RenderTransformOrigin="1,0.5" Fill="{StaticResource RightSideShadingBrush}" OpacityMask="{StaticResource OpacityMaskShadingBrush}"/>

                                    <Grid x:Name="summaryAnimPanel" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,230,34,0">
                                        <Grid.RenderTransform>
                                            <TranslateTransform X="0"/>
                                        </Grid.RenderTransform>

                                        <Control x:Name="summaryPanel" IsEnabled="False" ls:MoveFocus.IsMoveFocusScope="True" Template="{StaticResource summaryPanelTemplate}"  HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,0,16,0"/>

                                        <ls:LSButton x:Name="focusGameplayPanelButton" 
                                                     Visibility="Hidden"
                                                     Tag=" "
                                                     ContentTemplate="{StaticResource ControllerButtonHint}" 
                                                     Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='ToggleSummaryFocus'}"
                                                     BoundEvent="ToggleSummaryFocus"
                                                     HorizontalAlignment="Right"
                                                     VerticalAlignment="Top">
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="Click" >
                                                    <ls:SetMoveFocusAction TargetName="CharacterCreation_c" Reset="True"/>
                                                    <b:InvokeCommandAction Command="{Binding HideTooltipOnUIElementCommand, ElementName=CharacterCreation_c}"/>
                                                    <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="False" />
                                                    <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Visible" />
                                                    <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                    <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource unfocusSummaryPanelStoryboard}"/>
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                        </ls:LSButton>

                                        <ls:LSButton x:Name="focusSummaryPanelButton" 
                                                     Tag=" " 
                                                     ContentTemplate="{StaticResource ControllerButtonHint}"  
                                                     Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='ToggleSummaryFocus'}" 
                                                     BoundEvent="ToggleSummaryFocus"
                                                     HorizontalAlignment="Right"
                                                     VerticalAlignment="Top">
                                            <b:Interaction.Triggers>
                                                <b:EventTrigger EventName="Click" >
                                                    <b:InvokeCommandAction Command="{Binding EnableTooltipOnUIElementCommand, ElementName=CharacterCreation_c}"/>
                                                    <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="True" />
                                                    <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                    <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Visible" />
                                                    <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=summaryPanel}"/>
                                                    <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource focusSummaryPanelStoryboard}"/>
                                                </b:EventTrigger>
                                            </b:Interaction.Triggers>
                                        </ls:LSButton>

                                    </Grid>
                                </Grid>

                                <!-- Naming Page Bottom Buttons -->
                                <StackPanel Style="{StaticResource ButtonHint.Container.Right}">

                                    <ls:LSButton x:Name="showSummary" Visibility="{Binding ElementName=summary, Path=Visibility, Converter={StaticResource InvertVisibilityConverter}}" ContentTemplate="{StaticResource ControllerButtonHint}" Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UISort, Converter={StaticResource FindInputEventConverter}}" BoundEvent="UISort" Tag="{Binding Source=h890f4cddg2bdcg4bb2gb73eg43fe16b11b08,Converter={StaticResource TranslatedStringConverter}}" TapTime="{StaticResource DefaultButtonTapTime}">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click">
                                                <b:ChangePropertyAction TargetName="summary" PropertyName="Tag" Value="ShowIfPossible" />
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>
                                    <ls:LSButton x:Name="hideSummary" Visibility="{Binding ElementName=summary, Path=Visibility}" ContentTemplate="{StaticResource ControllerButtonHint}" Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UISort, Converter={StaticResource FindInputEventConverter}}" BoundEvent="UISort" Tag="{Binding Source=h70ec62ddg0cfcg4512ga0c6gbc591945b75b,Converter={StaticResource TranslatedStringConverter}}" TapTime="{StaticResource DefaultButtonTapTime}">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click">
                                                <b:ChangePropertyAction TargetName="summary" PropertyName="Tag" Value="HideIfPossible" />
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>

                                    <ls:LSButton x:Name="backFromNamingButton"
                                    ContentTemplate="{StaticResource ControllerButtonHint}" 
                                    Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UICreate, Converter={StaticResource FindInputEventConverter}}" 
                                    BoundEvent="UICreate" 
                                    Tag="{Binding Source=h77fec760g866dg4e47g8e81g467c9c05e447,Converter={StaticResource TranslatedStringConverter}}" 
                                    Margin="50,0,0,0">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click">
                                                <b:ChangePropertyAction TargetName="gamePlayPage" PropertyName="Visibility" Value="Visible" />
                                                <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Collapsed" />
                                                <ls:SetMoveFocusAction TargetName="CharacterCreation_c" FocusElement="{Binding ElementName=gamePlayPage}"/>

                                                <b:ChangePropertyAction TargetName="summaryPanel" PropertyName="IsEnabled" Value="False" />
                                                <b:ChangePropertyAction TargetName="focusSummaryPanelButton" PropertyName="Visibility" Value="Visible" />
                                                <b:ChangePropertyAction TargetName="focusGameplayPanelButton" PropertyName="Visibility" Value="Hidden" />
                                                <b:ControlStoryboardAction ControlStoryboardOption="Play" Storyboard="{StaticResource unfocusSummaryPanelStoryboard}"/>

                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>

                                </StackPanel>

                            </Grid>
                            <ControlTemplate.Triggers>
                                <!--Note: Can't use "CanEditName" as it changes for daisy and during finish state. Origins should have a "IsLockedName" property-->
                                <DataTrigger Binding="{Binding Path=SelectedOrigin.IsLockedAppearance}" Value="True">
                                    <Setter TargetName="characterName" Property="Text" Value="{Binding SelectedOrigin.Name, Mode=OneWay}"/>
                                    <Setter TargetName="CharacterNameHeader" Property="ls:TextBlockFormatter.SourceText" Value="{Binding Source=hfaa5d318g5f40g47eegac3bga7134a42232f, Converter={StaticResource TranslatedStringConverter}}"/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding Layout}" Value="Common">
                                    <Setter TargetName="summary" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Tag, ElementName=summary}" Value="ShowIfPossible">
                                    <Setter TargetName="summary" Property="Visibility" Value="Visible"/>
                                    <Setter TargetName="summary" Property="Tag" Value=""/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Tag, ElementName=summary}" Value="HideIfPossible">
                                    <Setter TargetName="summary" Property="Visibility" Value="Collapsed"/>
                                    <Setter TargetName="summary" Property="Tag" Value=""/>
                                </DataTrigger>

                                <DataTrigger Binding="{Binding IsCharacterCompleteExceptName}" Value="False">
                                    <Setter TargetName="gotoDaisyButton" Property="IsEnabled" Value="False"/>
                                    <Setter TargetName="MissingRequirementsError" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Validity.Name}" Value="False">
                                    <Setter TargetName="gotoDaisyButton" Property="IsEnabled" Value="False"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Validity.SameOriginSelectedByMultiplePlayers}" Value="False">
                                    <Setter TargetName="gotoDaisyButton" Property="IsEnabled" Value="False"/>
                                </DataTrigger>

                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Control.Template>
                </Control>

                <Control x:Name="daisyPage" Visibility="Collapsed">
                    <Control.Template>
                        <ControlTemplate TargetType="Control">
                            <Grid>
                                <Grid.Resources>
                                    <!-- Replacements for Avatar Appearance Templates -->
                                    <ControlTemplate x:Key="StandardBottomButtonsTemplate2">
                                        <StackPanel Orientation="Horizontal">
                                            <!-- Toggle tooltips -->
                                            <!-- <ls:LSButton x:Name="ToggleTooltips"
                                                         ContentTemplate="{StaticResource ControllerButtonHint}"
                                                         Tag="{Binding Source='hf8dd4c2fg97e0g4ccdgac1ag3cd1fe5060ef', Converter={StaticResource TranslatedStringConverter}}" 
                                                         TapTime="{StaticResource DefaultButtonTapTime}"
                                                         Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UIShowInfo, Converter={StaticResource FindInputEventConverter}}"
                                                         Command="ls:UIWidget.ToggleTooltipOnUIElementCommand"
                                                         CommandParameter="{Binding FocusedElement, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ls:UIWidget}}"
                                                         BoundEvent="UIShowInfo"/> -->

                                            <ls:LSButton x:Name="backFromDaisyButton"
                                            ContentTemplate="{StaticResource ControllerButtonHint}" 
                                            Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UICancel, Converter={StaticResource FindInputEventConverter}}" 
                                            BoundEvent="UICancel" 
                                            Tag="{Binding Source=h77fec760g866dg4e47g8e81g467c9c05e447,Converter={StaticResource TranslatedStringConverter}}" 
                                            Margin="50,0,0,0">
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="Click">
                                                        <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Visible" />
                                                        <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Naming"/>
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ls:LSButton>
                                        </StackPanel>
                                    </ControlTemplate>

                                    <ControlTemplate x:Key="AppearanceItemSelectableBottomButtons">
                                        <StackPanel Orientation="Horizontal">

                                            <ls:LSButton x:Name="selectButton" ContentTemplate="{StaticResource ControllerButtonHint}" Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UIAccept, Converter={StaticResource FindInputEventConverter}}" Tag="{Binding Source=hd0c08193ga7f2g4a7eg8225g63748c7b3096,Converter={StaticResource TranslatedStringConverter}}" Margin="50,0,0,0">
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="LSInputBindingPressed" >
                                                        <ls:LSPlaySound Sound="UI_DefaultButton_Click"/>
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ls:LSButton>

                                            <ls:LSButton x:Name="backFromDaisyButton"
                                        ContentTemplate="{StaticResource ControllerButtonHint}" 
                                        Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UICancel, Converter={StaticResource FindInputEventConverter}}" 
                                        BoundEvent="UICancel" 
                                        Tag="{Binding Source=h77fec760g866dg4e47g8e81g467c9c05e447,Converter={StaticResource TranslatedStringConverter}}" 
                                        Margin="50,0,0,0">
                                                <b:Interaction.Triggers>
                                                    <b:EventTrigger EventName="Click">
                                                        <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Visible" />
                                                        <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Collapsed" />
                                                    </b:EventTrigger>
                                                </b:Interaction.Triggers>
                                            </ls:LSButton>
                                        </StackPanel>
                                    </ControlTemplate>
                                    
                                    <BitmapImage x:Key="daisyBackdrop" UriSource="pack://application:,,,/Core;component/Assets/CC_c/c_titleBG_guardian.png"/>
                                </Grid.Resources>

                                <b:Interaction.Triggers>
                                    <b:DataTrigger Binding="{Binding ElementName=daisyPage, Path=Visibility}" Value="Visible">
                                        <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Companion"/>
                                    </b:DataTrigger>
                                </b:Interaction.Triggers>

                                <Control x:Name="setCameras" Template="{StaticResource setDaisyCamera_Splitscreen}"/>
                                <Control Template="{StaticResource AppearanceBackgroundTemplate}"/>
                                <Rectangle x:Name="bottomShading" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Height="{StaticResource bottomBackgroundHeight}" Fill="{StaticResource BottomShadingBrush}"/>

                                <ls:LSNineSliceImage x:Name="daisyHeader" Slices="240,130,820,130" MinWidth="800" MinHeight="264" ImageSource="{StaticResource daisyBackdrop}" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="176,146,0,0" Padding="40 20 100 0">
                                    <TextBlock x:Name="pageTitle" ls:TextBlockFormatter.SourceText="{Binding Source=h0606bec2g5227g499ag8f4bg9ab2589ccded, Converter={StaticResource TranslatedStringConverter}}" FontSize="{StaticResource ScaledTitleFontSize}" Foreground="{StaticResource LS_extraspecialTxtColor}" TextWrapping="Wrap" VerticalAlignment="Top" Margin="40 20 40 20" MaxWidth="700"/>
                                </ls:LSNineSliceImage>

                                <Control x:Name="appearancePanel" Template="{StaticResource AppearancePanelTemplate}" Height="1700" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,212,50,0"/>

                                <ContentControl Template="{StaticResource buttonBackplateTemplate}" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,148">

                                    <ls:LSButton x:Name="VentureForthButton" Style="{StaticResource ControllerHoldButtonStyle}" Content="{Binding CurrentPlayer.UIData.InputEvents, Converter={StaticResource FindInputEventConverter}, ConverterParameter='UIDelete'}" Tag="{Binding Source='h06b74424gf3bdg4b6cgbe63g84b32198e162', Converter={StaticResource TranslatedStringConverter}}" Command="{Binding DataContext.FinishCreating, RelativeSource={RelativeSource AncestorType={x:Type ls:UIWidget}}}" SoundID="UI_HUD_CC_VentureForth" Margin="2,0,0,0">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click">
                                                <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Collapsed" />
                                            </b:EventTrigger>
                                            <b:EventTrigger EventName="LSButtonReleased">
                                                <ls:LSPlaySound Sound="UI_HUD_CC_VentureForth_Controller_Release"/>
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>

                                </ContentControl>

                                <!-- Daisy Page Bottom Buttons -->
                                <StackPanel  Style="{StaticResource ButtonHint.Container.Right}">
                                    <Control x:Name="bottomButtons"/>
                                </StackPanel>

                            </Grid>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding Layout}" Value="Common">
                                    <Setter TargetName="setCameras" Property="Template" Value="{StaticResource setDaisyCamera}"/>
                                    <Setter TargetName="appearancePanel" Property="Margin" Value="0,212,200,0"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Layout}" Value="Left">
                                    <Setter TargetName="pageTitle" Property="Style" Value="{StaticResource CCBaseText}"/>
                                    <Setter TargetName="daisyHeader" Property="Margin" Value="60 60 0 0"/>
                                </DataTrigger>
                                <DataTrigger Binding="{Binding Layout}" Value="Right">
                                    <Setter TargetName="pageTitle" Property="Style" Value="{StaticResource CCBaseText}"/>
                                    <Setter TargetName="daisyHeader" Property="Margin" Value="60 60 0 0"/>
                                </DataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Control.Template>
                </Control>

                <Control x:Name="readyInfoPage" Visibility="Collapsed">
                    <Control.Template>
                        <ControlTemplate TargetType="Control">
                            <Grid>
                                <b:Interaction.Triggers>
                                    <b:PropertyChangedTrigger Binding="{Binding Layout}">
                                        <b:Interaction.Behaviors>
                                            <b:ConditionBehavior>
                                                <b:ConditionalExpression>
                                                    <b:ComparisonCondition LeftOperand="{Binding Layout}" Operator="Equal" RightOperand="Common"/>
                                                    <b:ComparisonCondition LeftOperand="{Binding CharacterCreationStep}" Operator="Equal" RightOperand="Finish"/>
                                                    <b:ComparisonCondition LeftOperand="{Binding Data.Players.Count}" Operator="Equal" RightOperand="1"/>
                                                </b:ConditionalExpression>
                                            </b:ConditionBehavior>
                                        </b:Interaction.Behaviors>
                                        <!--Second player in splitscreen disconnects while first player ready-->
                                        <b:InvokeCommandAction Command="{Binding CancelReady}"  CommandParameter="Companion"/>
                                        <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Visible" />
                                    </b:PropertyChangedTrigger>

                                    <b:DataTrigger Binding="{Binding ElementName=readyInfoPage, Path=Visibility}" Value="Visible">
                                        <b:InvokeCommandAction Command="{Binding SetCameraMode}" CommandParameter="Overview"/>
                                        <b:InvokeCommandAction Command="{Binding Path=SetCameraOffsets}">
                                            <b:InvokeCommandAction.CommandParameter>
                                                <MultiBinding Converter="{StaticResource PassThroughConverter}">
                                                    <Binding>
                                                        <Binding.Source>
                                                            <System:Single>-6.0</System:Single>
                                                        </Binding.Source>
                                                    </Binding>
                                                    <Binding>
                                                        <Binding.Source>
                                                            <System:Single>-2.2</System:Single>
                                                        </Binding.Source>
                                                    </Binding>
                                                    <Binding>
                                                        <Binding.Source>
                                                            <System:Single>-2.2</System:Single>
                                                        </Binding.Source>
                                                    </Binding>
                                                </MultiBinding>
                                            </b:InvokeCommandAction.CommandParameter>
                                        </b:InvokeCommandAction>
                                    </b:DataTrigger>
                                </b:Interaction.Triggers>

                                <Rectangle x:Name="upperShading" Height="200" VerticalAlignment="Top" HorizontalAlignment="Stretch">
                                    <Rectangle.Fill>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1" >
                                            <GradientStop Color="Black" Offset="0" />
                                            <GradientStop Color="{StaticResource transparentBlack}" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Rectangle.Fill>
                                </Rectangle>
                                
                                <Rectangle x:Name="bottomShading" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Height="{StaticResource bottomBackgroundHeight}" Fill="{StaticResource BottomShadingBrush}"/>

                                <TextBlock ls:TextBlockFormatter.SourceText="{Binding Source=hd0893eb3gec78g4c1ag8c10gf4860d887ff9, Converter={StaticResource TranslatedStringConverter}}" Style="{StaticResource PanelHeaderText}" VerticalAlignment="Top" Margin="0,50,0,0"/>

                                <!-- Waiting for other Players... -->
                                <TextBlock x:Name="waitingMessage" Visibility="Collapsed" ls:TextBlockFormatter.SourceText="{Binding Source=he3eaec5bg75f0g4856g9b67g8cabfb128f56, Converter={StaticResource TranslatedStringConverter}}" Style="{StaticResource PanelHeaderText}" VerticalAlignment="Bottom" Margin="0,0,0,50"/>

                                <ContentControl x:Name="cancelButton" Template="{StaticResource buttonBackplateTemplate}" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,150">
                                    <ls:LSButton
                                        Command="{Binding CancelReady}"
                                        CommandParameter="Companion"
                                        ContentTemplate="{StaticResource ControllerButtonHint}" 
                                        Content="{Binding CurrentPlayer.UIData.InputEvents, ConverterParameter=UICancel, Converter={StaticResource FindInputEventConverter}}" 
                                        BoundEvent="UICancel" 
                                        Tag="{Binding Source=h77fec760g866dg4e47g8e81g467c9c05e447,Converter={StaticResource TranslatedStringConverter}}">
                                        <b:Interaction.Triggers>
                                            <b:EventTrigger EventName="Click" >
                                                <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Visible" />
                                            </b:EventTrigger>
                                        </b:Interaction.Triggers>
                                    </ls:LSButton>
                                </ContentControl>

                            </Grid>
                            <ControlTemplate.Triggers>
                                <DataTrigger Binding="{Binding Layout}" Value="Common">
                                    <Setter TargetName="waitingMessage" Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Control.Template>
                </Control>

                <StackPanel x:Name="PlayerSlotsContainer" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" Margin="0,25,25,0">
                    <Control x:Name="PlayerSlots" Template="{StaticResource PlayerSlotsTemplate}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="PressToJoinText" Foreground="{StaticResource LS_accent75TxtColor}" FontSize="{StaticResource ScaledSmallishFontSize}"
                               VerticalAlignment="Center" Visibility="Collapsed" Opacity="0" Margin="12,-18,0,18">
                        <b:Interaction.Behaviors>
                            <ls:CtxTransStringRunGeneratorBehavior LocaSource="{Binding Source='h562afe65ge87fg4863gb4fcg56a432b35903',Converter={StaticResource TranslatedStringConverter}}" 
                                                                   PlayerId="{Binding DataContext.CurrentPlayer.PlayerId, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ls:UIWidget}}}" 
                                                                   NamedParamContentStyle="{StaticResource ParamContentControllerStyle}"/>
                        </b:Interaction.Behaviors>
                    </TextBlock>
                </StackPanel>

                <ls:LSInputBinding x:Name="PinTooltipBinding" Style="{StaticResource PinTooltipBindingStyle}" EatInput="False"/>

                <!-- Daisy mode UICancel handling - allow returning to naming page -->
                <ls:LSInputBinding x:Name="DaisyModeCancel" BoundEvent="UICancel" EatInput="True">
                    <ls:LSInputBinding.IsEnabled>
                        <MultiBinding Converter="{StaticResource EqualConverter}">
                            <Binding Path="CharacterCreationStep"/>
                            <Binding Source="Companion"/>
                        </MultiBinding>
                    </ls:LSInputBinding.IsEnabled>
                    <b:Interaction.Triggers>
                        <!-- Allow going back to naming page -->
                        <b:EventTrigger EventName="LSInputBindingPressed">
                            <b:ChangePropertyAction TargetName="gamePlayPage" PropertyName="Visibility" Value="Visible" />
                            <b:ChangePropertyAction TargetName="namingPage" PropertyName="Visibility" Value="Visible" />
                            <b:ChangePropertyAction TargetName="daisyPage" PropertyName="Visibility" Value="Collapsed" />
                            <b:InvokeCommandAction Command="{Binding SetCharacterCreationStep}" CommandParameter="Naming"/>
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </ls:LSInputBinding>

                <ls:LSInputBinding x:Name="RotateLeftBinding" BoundEvent="CharacterCreationRotateLeft" GameInputCommand="{Binding GameInputRotateLeftCommand}"/>
                <ls:LSInputBinding x:Name="RotateRightBinding" BoundEvent="CharacterCreationRotateRight" GameInputCommand="{Binding GameInputRotateRightCommand}"/>
                <ls:LSInputBinding x:Name="PrevCameraBinding" BoundEvent="CameraZoomOut" Command="{Binding PrevCameraMode}"/>
                <ls:LSInputBinding x:Name="NextCameraBinding" BoundEvent="CameraZoomIn" Command="{Binding NextCameraMode}"/>
            </Grid>

            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding DataContext.Layout, RelativeSource={RelativeSource AncestorType={x:Type ls:UIWidget}}}" Value="Right">
                    <Setter TargetName="PlayerSlots" Property="Visibility" Value="Collapsed"/>
                </DataTrigger>

                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding Data.Players.Count}" Value="1"/>
                        <Condition Binding="{Binding Data.ConnectedControllers, Converter={StaticResource GreaterThanConverter}, ConverterParameter=1}" Value="True"/>
                    </MultiDataTrigger.Conditions>
                    <MultiDataTrigger.EnterActions>
                        <BeginStoryboard Name="IconBounce">
                            <BeginStoryboard.Storyboard>
                                <Storyboard FillBehavior="Stop">
                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="Opacity" Storyboard.TargetName="PressToJoinText">
                                        <EasingDoubleKeyFrame KeyTime="0:0:0" Value="0"/>
                                        <EasingDoubleKeyFrame KeyTime="0:0:1" Value="1"/>
                                        <EasingDoubleKeyFrame KeyTime="0:0:6" Value="1"/>
                                        <EasingDoubleKeyFrame KeyTime="0:0:7" Value="0"/>
                                    </DoubleAnimationUsingKeyFrames>
                                    <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Visibility" Storyboard.TargetName="PressToJoinText">
                                        <DiscreteObjectKeyFrame KeyTime="0:0:0" Value="{x:Static Visibility.Visible}"/>
                                        <DiscreteObjectKeyFrame KeyTime="0:0:7" Value="{x:Static Visibility.Collapsed}"/>
                                    </ObjectAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard.Storyboard>
                        </BeginStoryboard>
                    </MultiDataTrigger.EnterActions>
                </MultiDataTrigger>

            </DataTemplate.Triggers>
        </DataTemplate>
    </ls:UIWidget.ContentTemplate>
</ls:UIWidget>